<!DOCTYPE html>
<html>
  <head>
    <title>Infinite Stairs</title>
    <meta name="description" content="Textures - A-Frame School">
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
  </head>

  <body>
    <a-scene>
      <a-assets>
        <img id="sky1" src="projectassets/clouds5.jpg">
        <img id="stairsTex" src="projectassets/texture11.jpeg">
        <img id="lowerPlaneTex" src="projectassets/texture12.jpg">
        <a-asset-item id="cloudObj" src="projectassets/cloud.obj"></a-asset-item>
      </a-assets>

      <a-sky src="#sky1" radius="100"></a-sky>

      <a-circle id="lowerPlane"
                position="0 -1 -6"
                rotation="-90 0 0"
                radius="7"
                material="src: #lowerPlaneTex; repeat: 4 4; roughness: 0.9; metalness: 0.1; side: double">
      </a-circle>
      <a-entity id="staircase" position="0 -2 -4"></a-entity>

      <a-entity id="cloud-group"></a-entity>

      <script>
        AFRAME.registerComponent('build-stairs', {
          init: function () {
            const stairs = this.el;
            const numberOfSteps = 100;
            const stepHeight = 0.3;
            const stepDepth = 1;
            let width = 5;

            for (let i = 0; i < numberOfSteps; i++) {
              const y = i * stepHeight;
              const z = -(i * stepDepth);

              const step = document.createElement('a-box');
              step.setAttribute('position', `0 ${y} ${z}`);
              step.setAttribute('width', width);
              step.setAttribute('height', 0.25);
              step.setAttribute('depth', stepDepth);
              step.setAttribute('material', {
                src: '#stairsTex',
                roughness: 0.8,
                metalness: 0.1
              });

              stairs.appendChild(step);
              width *= 0.985;
            }
          }
        });

        document.addEventListener('DOMContentLoaded', () => {
          document.querySelector('#staircase').setAttribute('build-stairs', '');
        });
      </script>
    </a-scene>

    <script>
      AFRAME.registerComponent('scatter-clouds-obj', {
        init: function () {
          const container = this.el;
          const count = 80;
          const maxRadius = 80;

          for (let i = 0; i < count; i++) {
            // Random radius 0–100
            const r = Math.random() * maxRadius + 20;

            // Random spherical angles
            const theta = Math.random() * Math.PI * 2;
            const phi = Math.acos(2 * Math.random() - 1);

            // Spherical → cartesian
            const x = r * Math.sin(phi) * Math.cos(theta);
            const y = r * Math.sin(phi) * Math.sin(theta);
            const z = r * Math.cos(phi);

            const cloud = document.createElement('a-entity');

            cloud.setAttribute('position', `${x} ${y} ${z}`);

            cloud.setAttribute('obj-model', 'obj: #cloudObj');

            const s = 0.0005;
            cloud.setAttribute('scale', `${s} ${s} ${s}`);

            cloud.setAttribute('material', 'color: #d8bfff; opacity: 0.8; transparent: true');

            container.appendChild(cloud);
          }
        }
      });

      document.addEventListener('DOMContentLoaded', () => {
        const group = document.querySelector('#cloud-group');
        group.setAttribute('scatter-clouds-obj', '');
      });
    </script>
  </body>
</html>
