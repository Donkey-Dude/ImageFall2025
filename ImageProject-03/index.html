<!DOCTYPE html>
<html>
  <head>
    <title>Infinite Stairs</title>
    <meta name="description" content="Textures - A-Frame School">
    <script src="https://aframe.io/releases/1.5.0/aframe.min.js"></script>
    <!-- Extra loaders so collada-model (.dae) works reliably -->
    <script src="https://cdn.jsdelivr.net/gh/donmccurdy/aframe-extras@6.1.1/dist/aframe-extras.loaders.min.js"></script>
  </head>

  <body>
    <a-scene>
      <!-- ASSETS -->
      <a-assets>
        <img id="sky1" src="projectassets/clouds5.jpg">
        <img id="stairsTex" src="projectassets/texture11.jpeg">
        <img id="lowerPlaneTex" src="projectassets/texture12.jpg">
      </a-assets>

      <!-- SKY -->
      <a-sky src="#sky1" radius="100"></a-sky>

      <!-- LOWER CIRCLE PLANE -->
      <a-circle id="lowerPlane"
                position="0 -1 -6"
                rotation="-90 0 0"
                radius="10"
                material="src: #lowerPlaneTex; repeat: 4 4; roughness: 0.9; metalness: 0.1; side: double">
      </a-circle>

      <!-- STAIRCASE CONTAINER -->
      <a-entity id="staircase" position="0 -2 -4"></a-entity>

      <!-- BUILD STAIRS SCRIPT -->
      <script>
        AFRAME.registerComponent('build-stairs', {
          init: function () {
            const stairs = this.el;
            const numberOfSteps = 100;
            const stepHeight = 0.3;
            const stepDepth = 1;
            let width = 5;

            for (let i = 0; i < numberOfSteps; i++) {
              const y = i * stepHeight;
              const z = -(i * stepDepth);

              const step = document.createElement('a-box');
              step.setAttribute('position', `0 ${y} ${z}`);
              step.setAttribute('width', width);
              step.setAttribute('height', 0.25);
              step.setAttribute('depth', stepDepth);
              step.setAttribute('material', {
                src: '#stairsTex',
                roughness: 0.8,
                metalness: 0.1
              });

              stairs.appendChild(step);
              width *= 0.985;
            }
          }
        });

        document.addEventListener('DOMContentLoaded', () => {
          document.querySelector('#staircase').setAttribute('build-stairs', '');
        });
      </script>

    </a-scene>
    </script>
  </body>
</html>
